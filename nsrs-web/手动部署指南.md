# NSRS-Web æ‰‹åŠ¨éƒ¨ç½²æŒ‡å—

## ğŸ“¦ æœ¬åœ°æ‰“åŒ…

### 1. æ‰§è¡Œæ‰“åŒ…è„šæœ¬

```cmd
# Windowsç”¨æˆ· (æ¨èä½¿ç”¨PowerShellç‰ˆæœ¬)
build-for-deploy.ps1

# æˆ–è€…ä½¿ç”¨æ‰¹å¤„ç†ç‰ˆæœ¬
build-for-deploy.bat
```

**é‡è¦ä¿®å¤ï¼š** å·²ä¿®å¤Tomcatéƒ¨ç½²æ—¶çš„404é—®é¢˜ï¼š
- âœ… ä¿®æ”¹äº†Viteé…ç½®ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆ`base: './`ï¼‰
- âœ… ä¿®å¤äº†favicon.pngçš„è·¯å¾„é—®é¢˜
- âœ… é…ç½®äº†æ­£ç¡®çš„SPAè·¯ç”±é‡å®šå‘

**å¦‚æœä»é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š**
1. Tomcatç‰ˆæœ¬æ˜¯å¦æ”¯æŒï¼ˆå»ºè®®8.5+ï¼‰
2. WARæ–‡ä»¶æ˜¯å¦æ­£ç¡®éƒ¨ç½²åˆ°webappsç›®å½•
3. è®¿é—®åœ°å€æ˜¯å¦æ­£ç¡®ï¼š`http://server-ip:8080/nsrs/`

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- æ¸…ç†æ—§æ–‡ä»¶
- æ„å»ºé¡¹ç›®
- åˆ›å»º WAR åŒ…

### 2. æ‰“åŒ…ç»“æœ

æ‰“åŒ…å®Œæˆåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆï¼š
- `nsrs.war` - å¯éƒ¨ç½²çš„ WAR æ–‡ä»¶

## ğŸš€ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ

1. **å¤‡ä»½ç°æœ‰åº”ç”¨**ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
   ```bash
   sudo cp -r /opt/tomcat/webapps/nsrs /opt/tomcat/webapps/nsrs.backup.$(date +%Y%m%d_%H%M%S)
   ```

2. **å°† WAR æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨**
   ```bash
   # ä½¿ç”¨ SCP
   scp nsrs.war user@server-ip:~/
   
   # æˆ–ä½¿ç”¨ FTP/SFTP å·¥å…·ä¸Šä¼ 
   ```

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åˆ° Tomcat

1. **åœæ­¢ Tomcat æœåŠ¡**
   ```bash
   sudo systemctl stop tomcat
   # æˆ–
   sudo /opt/tomcat/bin/shutdown.sh
   ```

2. **æ¸…ç†æ—§åº”ç”¨**
   ```bash
   # åˆ é™¤æ—§çš„åº”ç”¨ç›®å½•
   sudo rm -rf /opt/tomcat/webapps/nsrs
   
   # åˆ é™¤æ—§çš„ WAR æ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
   sudo rm -f /opt/tomcat/webapps/nsrs.war
   ```

3. **éƒ¨ç½²æ–°åº”ç”¨**
   ```bash
   # ç§»åŠ¨ WAR æ–‡ä»¶åˆ° webapps ç›®å½•
   sudo mv ~/nsrs.war /opt/tomcat/webapps/
   
   # è®¾ç½®æ­£ç¡®çš„æƒé™
   sudo chown tomcat:tomcat /opt/tomcat/webapps/nsrs.war
   ```

4. **å¯åŠ¨ Tomcat æœåŠ¡**
   ```bash
   sudo systemctl start tomcat
   # æˆ–
   sudo /opt/tomcat/bin/startup.sh
   ```

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯éƒ¨ç½²

1. **ç­‰å¾…åº”ç”¨è§£å‹**
   - Tomcat å¯åŠ¨åä¼šè‡ªåŠ¨è§£å‹ WAR æ–‡ä»¶
   - é€šå¸¸éœ€è¦ 1-2 åˆ†é’Ÿ

2. **æ£€æŸ¥åº”ç”¨çŠ¶æ€**
   ```bash
   # æ£€æŸ¥ Tomcat æ—¥å¿—
   tail -f /opt/tomcat/logs/catalina.out
   
   # æ£€æŸ¥åº”ç”¨ç›®å½•æ˜¯å¦åˆ›å»º
   ls -la /opt/tomcat/webapps/nsrs
   ```

3. **è®¿é—®åº”ç”¨**
   - æµè§ˆå™¨è®¿é—®ï¼š`http://æœåŠ¡å™¨IP:8080/nsrs/`
   - æˆ–ä½¿ç”¨ curl æµ‹è¯•ï¼š`curl -I http://æœåŠ¡å™¨IP:8080/nsrs/`

## ğŸ”§ å¸¸è§é—®é¢˜å¤„ç†

### é—®é¢˜1ï¼šåº”ç”¨æ— æ³•è®¿é—®

**å¯èƒ½åŸå› ï¼š**
- Tomcat æœåŠ¡æœªå¯åŠ¨
- é˜²ç«å¢™é˜»æ­¢ 8080 ç«¯å£
- WAR æ–‡ä»¶è§£å‹å¤±è´¥

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥ Tomcat çŠ¶æ€
sudo systemctl status tomcat

# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
sudo netstat -tlnp | grep 8080

# æ£€æŸ¥é˜²ç«å¢™
sudo firewall-cmd --list-ports
sudo firewall-cmd --add-port=8080/tcp --permanent
sudo firewall-cmd --reload
```

### é—®é¢˜2ï¼šé¡µé¢æ˜¾ç¤º 404

**å¯èƒ½åŸå› ï¼š**
- WAR æ–‡ä»¶åä¸æ­£ç¡®
- åº”ç”¨æœªå®Œå…¨è§£å‹
- web.xml é…ç½®é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥åº”ç”¨ç›®å½•
ls -la /opt/tomcat/webapps/

# æ£€æŸ¥åº”ç”¨å†…å®¹
ls -la /opt/tomcat/webapps/nsrs/

# é‡æ–°éƒ¨ç½²
sudo systemctl stop tomcat
sudo rm -rf /opt/tomcat/webapps/nsrs*
# é‡æ–°æ”¾ç½® WAR æ–‡ä»¶å¹¶å¯åŠ¨
```

### é—®é¢˜3ï¼šé™æ€èµ„æºåŠ è½½å¤±è´¥

**å¯èƒ½åŸå› ï¼š**
- è·¯å¾„é…ç½®ä¸æ­£ç¡®
- ç¼“å­˜é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**
- å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ (Ctrl+F5)
- æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ç½‘ç»œé¢æ¿
- ç¡®è®¤ vite.config.ts ä¸­çš„ base è·¯å¾„é…ç½®

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] æœ¬åœ°æ„å»ºæˆåŠŸ
- [ ] WAR æ–‡ä»¶ç”Ÿæˆæ­£å¸¸
- [ ] æœåŠ¡å™¨è¿æ¥æ­£å¸¸
- [ ] Tomcat æœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´

### éƒ¨ç½²åæ£€æŸ¥
- [ ] Tomcat æœåŠ¡å¯åŠ¨æˆåŠŸ
- [ ] WAR æ–‡ä»¶è‡ªåŠ¨è§£å‹
- [ ] åº”ç”¨ç›®å½•åˆ›å»ºå®Œæˆ
- [ ] é¦–é¡µå¯ä»¥æ­£å¸¸è®¿é—®
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸
- [ ] è·¯ç”±è·³è½¬åŠŸèƒ½æ­£å¸¸

## ğŸ”„ æ›´æ–°éƒ¨ç½²

å¯¹äºåç»­çš„åº”ç”¨æ›´æ–°ï¼Œå¯ä»¥ç®€åŒ–æµç¨‹ï¼š

1. **æœ¬åœ°é‡æ–°æ‰“åŒ…**
   ```cmd
   build-for-deploy.bat
   ```

2. **å¿«é€Ÿéƒ¨ç½²**
   ```bash
   # ä¸Šä¼ æ–°çš„ WAR æ–‡ä»¶
   scp nsrs.war user@server-ip:~/
   
   # åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
   sudo systemctl stop tomcat
   sudo rm -rf /opt/tomcat/webapps/nsrs
   sudo mv ~/nsrs.war /opt/tomcat/webapps/
   sudo chown tomcat:tomcat /opt/tomcat/webapps/nsrs.war
   sudo systemctl start tomcat
   ```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
- æ“ä½œç³»ç»Ÿç‰ˆæœ¬
- Tomcat ç‰ˆæœ¬
- Java ç‰ˆæœ¬
- é”™è¯¯æ—¥å¿—å†…å®¹
- éƒ¨ç½²æ­¥éª¤è¯¦æƒ…

---

**æ³¨æ„ï¼š** ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œç¡®ä¿åº”ç”¨åŠŸèƒ½æ­£å¸¸åå†éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚