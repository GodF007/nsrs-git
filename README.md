# NSRSå·å¡èµ„æºç®¡ç†ç³»ç»Ÿ

å·å¡èµ„æºç®¡ç†ç³»ç»Ÿï¼ˆNetwork SIM Resource Systemï¼Œç®€ç§°NSRSï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç½‘ç»œSIMå¡èµ„æºç®¡ç†ç³»ç»Ÿï¼Œç”¨äºç®¡ç†ç½‘ç»œé€šä¿¡ä¸­ä½¿ç”¨çš„SIMå¡èµ„æºã€å·ç èµ„æºå’ŒIMSIèµ„æºã€‚ç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œæ”¯æŒæ•°æ®åˆ†ç‰‡å’Œé«˜å¹¶å‘å¤„ç†ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### æŠ€æœ¯æ ˆ
- **åç«¯**: Spring Boot 2.x + MyBatis-Plus + ShardingSphere
- **å‰ç«¯**: React 19 + TypeScript + Ant Design + Vite
- **æ•°æ®åº“**: MySQL 8.0 (æ”¯æŒåˆ†åº“åˆ†è¡¨)
- **ç¼“å­˜**: Redis (æ”¯æŒé›†ç¾¤)
- **å®¹å™¨åŒ–**: Docker + Kubernetes
- **APIæ–‡æ¡£**: Knife4j (Swagger)

### ç³»ç»Ÿç‰¹æ€§
- ğŸ”„ **æ•°æ®åˆ†ç‰‡**: åŸºäºShardingSphereå®ç°IMSIèµ„æºè¡¨åˆ†ç‰‡å­˜å‚¨
- ğŸš€ **é«˜æ€§èƒ½**: æ”¯æŒæ‰¹é‡æ“ä½œå’Œå¼‚æ­¥å¤„ç†
- ğŸŒ **å›½é™…åŒ–**: æ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢
- ğŸ”’ **åˆ†å¸ƒå¼é”**: åŸºäºRedisçš„åˆ†å¸ƒå¼é”æœºåˆ¶
- ğŸ“Š **ç›‘æ§è¿ç»´**: é›†æˆActuatorå¥åº·æ£€æŸ¥å’ŒæŒ‡æ ‡ç›‘æ§
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**: å®Œæ•´çš„Kuberneteséƒ¨ç½²æ–¹æ¡ˆ

## ğŸ“¦ æ¨¡å—ç»“æ„

```
nsrs-parent/
â”œâ”€â”€ nsrs-boot/          # å¯åŠ¨æ¨¡å—
â”œâ”€â”€ nsrs-common/        # å…¬å…±æ¨¡å—
â”œâ”€â”€ nsrs-framework/     # æ¡†æ¶æ¨¡å—
â”œâ”€â”€ nsrs-binding/       # å·ç IMSIç»‘å®šæ¨¡å—
â”œâ”€â”€ nsrs-msisdn/        # å·ç èµ„æºç®¡ç†æ¨¡å—
â”œâ”€â”€ nsrs-simcard/       # SIMå¡èµ„æºç®¡ç†æ¨¡å—
â”œâ”€â”€ nsrs-web/           # å‰ç«¯ç•Œé¢æ¨¡å—
â””â”€â”€ nsrs-deploy/        # éƒ¨ç½²é…ç½®æ¨¡å—
```

## ğŸš€ æ¨¡å—åŠŸèƒ½è¯¦è§£

### nsrs-boot (å¯åŠ¨æ¨¡å—)
**åŠŸèƒ½**: Spring Bootåº”ç”¨å¯åŠ¨å…¥å£
- åº”ç”¨ä¸»ç±»å’Œå¯åŠ¨é…ç½®
- åŸºç¡€é…ç½®æ–‡ä»¶ (application.yml)
- Knife4j APIæ–‡æ¡£é…ç½®
- æœåŠ¡ç«¯å£: 8088
- ä¸Šä¸‹æ–‡è·¯å¾„: /nsrs

### nsrs-common (å…¬å…±æ¨¡å—)
**åŠŸèƒ½**: æä¾›é€šç”¨å·¥å…·ç±»å’ŒåŸºç¡€ç»„ä»¶

#### æ ¸å¿ƒç»„ä»¶
- **æšä¸¾ç±»**: 
  - `NumberStatusEnum`: å·ç çŠ¶æ€æšä¸¾
  - `OperationTypeEnum`: æ“ä½œç±»å‹æšä¸¾
  - `ApprovalStatusEnum`: å®¡æ‰¹çŠ¶æ€æšä¸¾
  - `BatchOperationTypeEnum`: æ‰¹é‡æ“ä½œç±»å‹æšä¸¾
  - `ResultStatusEnum`: ç»“æœçŠ¶æ€æšä¸¾

- **å·¥å…·ç±»**:
  - `SequenceService`: åºåˆ—å·ç”ŸæˆæœåŠ¡
  - `ShardingBatchUpdateUtils`: åˆ†ç‰‡æ‰¹é‡æ›´æ–°å·¥å…·
  - `EnumUtils`: æšä¸¾å·¥å…·ç±»
  - `MessageUtils`: æ¶ˆæ¯å·¥å…·ç±»

- **å¼‚å¸¸å¤„ç†**:
  - `BaseException`: åŸºç¡€å¼‚å¸¸ç±»
  - `BusinessException`: ä¸šåŠ¡å¼‚å¸¸ç±»
  - `AuthorizationException`: æˆæƒå¼‚å¸¸ç±»

- **ç»Ÿä¸€å“åº”**:
  - `CommonResult`: é€šç”¨å“åº”ç»“æœ
  - `PageResult`: åˆ†é¡µç»“æœå°è£…
  - `R`: å“åº”ç»“æœå·¥å…·ç±»

### nsrs-framework (æ¡†æ¶æ¨¡å—)
**åŠŸèƒ½**: æä¾›åŸºç¡€æ¡†æ¶é…ç½®å’ŒåŸºç¡€è®¾æ–½æ”¯æŒ

#### é…ç½®ç»„ä»¶
- **æ•°æ®åº“é…ç½®**: 
  - `DruidConfig`: æ•°æ®æºé…ç½®
  - `MybatisPlusConfig`: MyBatis-Plusé…ç½®
  - `CustomShardingConfigLoader`: è‡ªå®šä¹‰åˆ†ç‰‡é…ç½®åŠ è½½å™¨
  - `TransactionConfig`: äº‹åŠ¡é…ç½®

- **ç¼“å­˜é…ç½®**:
  - `RedisConfig`: Redisé…ç½®

- **Webé…ç½®**:
  - `WebConfig`: WebåŸºç¡€é…ç½®
  - `WebMvcConfig`: MVCé…ç½®
  - `CorsConfig`: è·¨åŸŸé…ç½®
  - `SwaggerConfig`: APIæ–‡æ¡£é…ç½®

- **å›½é™…åŒ–é…ç½®**:
  - `I18nConfig`: å›½é™…åŒ–é…ç½®

#### åŸºç¡€è®¾æ–½ç»„ä»¶
- **åˆ†å¸ƒå¼é”**:
  - `DistributedLock`: åˆ†å¸ƒå¼é”æ¥å£
  - `RedisDistributedLock`: Redisåˆ†å¸ƒå¼é”å®ç°
  - `@DistributedLockable`: åˆ†å¸ƒå¼é”æ³¨è§£
  - `DistributedLockAspect`: åˆ†å¸ƒå¼é”åˆ‡é¢

- **åˆ†ç‰‡ç®—æ³•**:
  - `IccidHashShardingAlgorithm`: ICCIDå“ˆå¸Œåˆ†ç‰‡ç®—æ³•
  - `MsisdnPrefixShardingAlgorithm`: MSISDNå‰ç¼€åˆ†ç‰‡ç®—æ³•

- **å¼‚å¸¸å¤„ç†**:
  - `GlobalExceptionHandler`: å…¨å±€å¼‚å¸¸å¤„ç†å™¨

### nsrs-binding (å·ç IMSIç»‘å®šæ¨¡å—)
**åŠŸèƒ½**: ç®¡ç†å·ç ä¸IMSIçš„ç»‘å®šå…³ç³»

#### æ ¸å¿ƒåŠŸèƒ½
- **å·ç IMSIç»‘å®šç®¡ç†**:
  - å·ç ä¸IMSIçš„ä¸€å¯¹ä¸€ç»‘å®š
  - ç»‘å®šå…³ç³»çš„åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤
  - ç»‘å®šçŠ¶æ€ç®¡ç†

- **æ‰¹é‡ç»‘å®šä»»åŠ¡**:
  - æ‰¹é‡ç»‘å®šä»»åŠ¡çš„åˆ›å»ºå’Œç®¡ç†
  - ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€è·Ÿè¸ª
  - ä»»åŠ¡ç»“æœç»Ÿè®¡

- **æ‰¹é‡ç»‘å®šè¯¦æƒ…**:
  - æ‰¹é‡æ“ä½œçš„è¯¦ç»†è®°å½•
  - æˆåŠŸ/å¤±è´¥è®°å½•è·Ÿè¸ª
  - é”™è¯¯ä¿¡æ¯è®°å½•

#### æ•°æ®è¡¨
- `number_imsi_binding`: å·ç IMSIç»‘å®šå…³ç³»è¡¨
- `batch_binding_task`: æ‰¹é‡ç»‘å®šä»»åŠ¡è¡¨
- `batch_binding_detail`: æ‰¹é‡ç»‘å®šè¯¦æƒ…è¡¨

#### APIæ¥å£
- å·ç IMSIç»‘å®šCRUDæ“ä½œ
- æ‰¹é‡ç»‘å®šä»»åŠ¡ç®¡ç†
- ç»‘å®šå…³ç³»æŸ¥è¯¢å’Œç»Ÿè®¡

### nsrs-msisdn (å·ç èµ„æºç®¡ç†æ¨¡å—)
**åŠŸèƒ½**: ç®¡ç†ç”µè¯å·ç èµ„æºçš„å…¨ç”Ÿå‘½å‘¨æœŸ

#### æ ¸å¿ƒåŠŸèƒ½
- **å·ç èµ„æºç®¡ç†**:
  - å·ç èµ„æºçš„CRUDæ“ä½œ
  - å·ç çŠ¶æ€ç®¡ç† (ç©ºé—²ã€å·²ç”¨ã€é¢„ç•™ã€æ¿€æ´»ã€å†»ç»“ã€é˜»å¡ã€é‡Šæ”¾)
  - æ‰¹é‡å¯¼å…¥å’Œå¯¼å‡º
  - è·¨è¡¨æŸ¥è¯¢æ”¯æŒ

- **å·ç æ®µç®¡ç†**:
  - å·ç æ®µçš„åˆ›å»ºå’Œé…ç½®
  - å·ç æ®µå®¹é‡ç»Ÿè®¡
  - å·ç æ®µçŠ¶æ€ç®¡ç†

- **å·ç çº§åˆ«ç®¡ç†**:
  - å·ç çº§åˆ«å®šä¹‰å’Œç®¡ç†
  - çº§åˆ«æƒé™æ§åˆ¶

- **å·ç æ¨¡å¼ç®¡ç†**:
  - å·ç æ ¼å¼æ¨¡å¼å®šä¹‰
  - æ­£åˆ™è¡¨è¾¾å¼éªŒè¯
  - æ¨¡å¼åŒ¹é…è§„åˆ™

- **å·ç å®¡æ‰¹ç®¡ç†**:
  - å·ç ç”³è¯·æµç¨‹
  - å®¡æ‰¹å·¥ä½œæµ
  - å®¡æ‰¹çŠ¶æ€è·Ÿè¸ª

- **HLR/äº¤æ¢æœºç®¡ç†**:
  - HLRè®¾å¤‡ç®¡ç†
  - äº¤æ¢æœºé…ç½®
  - è®¾å¤‡çŠ¶æ€ç›‘æ§

- **æ“ä½œæ—¥å¿—**:
  - å·ç æ“ä½œè®°å½•
  - æ“ä½œå®¡è®¡è·Ÿè¸ª
  - æ—¥å¿—æŸ¥è¯¢å’Œç»Ÿè®¡

#### æ•°æ®è¡¨
- `number_resource`: å·ç èµ„æºè¡¨
- `number_segment`: å·ç æ®µè¡¨
- `number_level`: å·ç çº§åˆ«è¡¨
- `number_pattern`: å·ç æ¨¡å¼è¡¨
- `number_approval`: å·ç å®¡æ‰¹è¡¨
- `number_operation_log`: å·ç æ“ä½œæ—¥å¿—è¡¨
- `hlr_switch`: HLR/äº¤æ¢æœºè¡¨

### nsrs-simcard (SIMå¡èµ„æºç®¡ç†æ¨¡å—)
**åŠŸèƒ½**: ç®¡ç†SIMå¡å’ŒIMSIèµ„æº

#### SIMå¡ç®¡ç†
- SIMå¡CRUDæ“ä½œ
- SIMå¡æ‰¹é‡å¯¼å…¥
- SIMå¡çŠ¶æ€ç®¡ç†
- SIMå¡åˆ†é…ä¸å›æ”¶

#### IMSIèµ„æºç®¡ç†
- **IMSIç»„ç®¡ç†**: 
  - åˆ›å»ºIMSIç»„ï¼Œè®¾ç½®IMSIèŒƒå›´
  - æ”¯æŒä¸åŒç±»å‹çš„IMSI
  - IMSIç»„é…ç½®å’Œç®¡ç†

- **IMSIèµ„æºç”Ÿæˆ**: 
  - æ ¹æ®IMSIç»„é…ç½®æŒ‰é¡ºåºç”ŸæˆIMSIèµ„æº
  - æ‰¹é‡ç”Ÿæˆå’Œå¯¼å…¥
  - èµ„æºé¢„åˆ†é…

- **IMSIèµ„æºæŸ¥è¯¢**: 
  - æŒ‰IMSIå·ç ã€ç»„ã€ä¾›åº”å•†ã€çŠ¶æ€ç­‰æ¡ä»¶æŸ¥è¯¢
  - æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢å’Œç²¾ç¡®æŸ¥è¯¢
  - åˆ†é¡µæŸ¥è¯¢æ”¯æŒ

- **IMSIèµ„æºçŠ¶æ€ç®¡ç†**: 
  - çŠ¶æ€å˜æ›´å’Œæ‰¹é‡æ“ä½œ
  - çŠ¶æ€æµè½¬æ§åˆ¶
  - çŠ¶æ€ç»Ÿè®¡æŠ¥è¡¨

#### æ•°æ®è¡¨åˆ†åŒº
- IMSIèµ„æºè¡¨æŒ‰å°¾ç¼€åˆ†è¡¨ï¼Œå…±åˆ†ä¸º10ä¸ªè¡¨ï¼ˆimsi_resource_0 è‡³ imsi_resource_9ï¼‰
- æ ¹æ®IMSIå·ç æœ€åä¸€ä½ç¡®å®šæ•°æ®å­˜å‚¨çš„è¡¨
- æ”¯æŒè·¨è¡¨æŸ¥è¯¢å’Œç»Ÿè®¡

#### APIæ¥å£
- `GET /simcard/imsi/group/page`: åˆ†é¡µæŸ¥è¯¢IMSIç»„åˆ—è¡¨
- `GET /simcard/imsi/group/{groupId}`: è·å–IMSIç»„è¯¦æƒ…
- `POST /simcard/imsi/group`: æ·»åŠ IMSIç»„
- `PUT /simcard/imsi/group`: ä¿®æ”¹IMSIç»„
- `DELETE /simcard/imsi/group/{groupId}`: åˆ é™¤IMSIç»„
- `GET /simcard/imsi/group/list`: è·å–æ‰€æœ‰IMSIç»„

### nsrs-web (å‰ç«¯ç•Œé¢æ¨¡å—)
**åŠŸèƒ½**: æä¾›Webç”¨æˆ·ç•Œé¢

#### æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: React 19 + TypeScript
- **UIç»„ä»¶**: Ant Design 5.x
- **è·¯ç”±**: TanStack Router
- **çŠ¶æ€ç®¡ç†**: Zustand
- **æ„å»ºå·¥å…·**: Vite 7.x
- **æ ·å¼**: Tailwind CSS
- **å›¾è¡¨**: Ant Design Charts
- **å›½é™…åŒ–**: i18next
- **HTTPå®¢æˆ·ç«¯**: Axios
- **Mockæ•°æ®**: MockJS

#### åŠŸèƒ½æ¨¡å—
- **SIMå¡ç®¡ç†**: SIMå¡èµ„æºçš„å¢åˆ æ”¹æŸ¥ç•Œé¢
- **IMSIç®¡ç†**: IMSIèµ„æºç®¡ç†ç•Œé¢
- **å·ç ç®¡ç†**: å·ç èµ„æºç®¡ç†ç•Œé¢
- **ç»‘å®šç®¡ç†**: å·ç IMSIç»‘å®šç®¡ç†ç•Œé¢
- **å¡é€‰ç®¡ç†**: å¡ç‰‡é€‰æ‹©ç®¡ç†ç•Œé¢

#### å¼€å‘é…ç½®
- å¼€å‘æœåŠ¡å™¨ç«¯å£: 3002
- æ”¯æŒçƒ­é‡è½½å’Œæ¨¡å—çƒ­æ›¿æ¢
- é›†æˆESLintå’ŒPrettierä»£ç è§„èŒƒ
- æ”¯æŒSVGå›¾æ ‡ç»„ä»¶åŒ–
- Mockæ•°æ®æ”¯æŒ

### nsrs-deploy (éƒ¨ç½²é…ç½®æ¨¡å—)
**åŠŸèƒ½**: æä¾›å®Œæ•´çš„éƒ¨ç½²è§£å†³æ–¹æ¡ˆ

#### éƒ¨ç½²æ–¹å¼
- **ç®€åŒ–éƒ¨ç½²** (`simple-deploy/`): é€‚ç”¨äºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
- **ç‰ˆæœ¬åŒ–éƒ¨ç½²** (`v1.0.0/`): é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒ

#### å®¹å™¨åŒ–é…ç½®
- **Dockerfile**: åŸºäºOpenJDK 8çš„åº”ç”¨é•œåƒ
- **Kubernetesé…ç½®**:
  - Namespace: èµ„æºéš”ç¦»
  - ConfigMap: åº”ç”¨é…ç½®ç®¡ç†
  - Deployment: åº”ç”¨éƒ¨ç½²è§„æ ¼
  - Service: æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡
  - Ingress: å¤–éƒ¨è®¿é—®å…¥å£

#### éƒ¨ç½²è„šæœ¬
- **é›†æˆæ„å»ºè„šæœ¬**: `build-integrated.sh/bat`
- **éƒ¨ç½²è„šæœ¬**: `deploy.sh/bat`
- **è‡ªåŠ¨åŒ–éƒ¨ç½²**: æ”¯æŒä¸€é”®éƒ¨ç½²

## ğŸ”§ ç³»ç»Ÿé…ç½®

### æ•°æ®åº“åˆ†ç‰‡é…ç½®
```yaml
spring:
  shardingsphere:
    datasource:
      names: ds0
    sharding:
      tables:
        imsi_resource:
          actual-data-nodes: ds0.imsi_resource_$->{0..9}
          table-strategy:
            inline:
              sharding-column: imsi
              algorithm-expression: imsi_resource_$->{imsi.longValue() % 10}
```

### Redisé…ç½®
```yaml
spring:
  redis:
    cluster:
      nodes:
        - redis-cluster-0.redis-cluster:6379
        - redis-cluster-1.redis-cluster:6379
        - redis-cluster-2.redis-cluster:6379
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- JDK 8+
- Node.js 16+
- MySQL 8.0+
- Redis 6.0+
- Maven 3.6+

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd NSRS
```

2. **åç«¯å¯åŠ¨**
```bash
# ç¼–è¯‘é¡¹ç›®
mvn clean compile

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run -pl nsrs-boot
```

3. **å‰ç«¯å¯åŠ¨**
```bash
cd nsrs-web
npm install
npm run dev
```

4. **è®¿é—®åº”ç”¨**
- åç«¯API: http://localhost:8088/nsrs
- APIæ–‡æ¡£: http://localhost:8088/nsrs/doc.html
- å‰ç«¯ç•Œé¢: http://localhost:3002

### ç”Ÿäº§éƒ¨ç½²

1. **æ„å»ºåº”ç”¨**
```bash
# é›†æˆæ„å»ºï¼ˆå‰ç«¯+åç«¯ï¼‰
./nsrs-deploy/build-integrated.sh
```

2. **Kuberneteséƒ¨ç½²**
```bash
cd nsrs-deploy/simple-deploy/scripts
./deploy.sh
```

3. **è®¿é—®åº”ç”¨**
- å¤–éƒ¨è®¿é—®: http://\<èŠ‚ç‚¹IP\>:30088/nsrs
- APIæ–‡æ¡£: http://\<èŠ‚ç‚¹IP\>:30088/nsrs/doc.html

## ğŸ“Š ç³»ç»Ÿç›‘æ§

### å¥åº·æ£€æŸ¥
- ç«¯ç‚¹: `/nsrs/actuator/health`
- æ”¯æŒå­˜æ´»æ¢é’ˆå’Œå°±ç»ªæ¢é’ˆ
- è‡ªåŠ¨æ•…éšœæ¢å¤

### æ—¥å¿—é…ç½®
- ä¸šåŠ¡æ—¥å¿—çº§åˆ«: DEBUG
- æ¡†æ¶æ—¥å¿—çº§åˆ«: WARN
- æ”¯æŒæ—¥å¿—èšåˆå’Œåˆ†æ

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- å†…ç½®æƒé™ç³»ç»Ÿ
- æ“ä½œå®¡è®¡æ—¥å¿—
- æ•°æ®è®¿é—®æ§åˆ¶
- åˆ†å¸ƒå¼é”é˜²å¹¶å‘

## ğŸ“ å¼€å‘è§„èŒƒ

- ä»£ç è§„èŒƒ: éµå¾ªé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ
- æäº¤è§„èŒƒ: ä½¿ç”¨Conventional Commits
- APIè®¾è®¡: RESTfulé£æ ¼
- æ•°æ®åº“è®¾è®¡: éµå¾ªä¸‰èŒƒå¼

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤å˜æ›´
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

Copyright Â© 2025 å·å¡èµ„æºç®¡ç†ç³»ç»Ÿ

---

**å·å¡èµ„æºç®¡ç†ç³»ç»Ÿ** - ä¸“ä¸šçš„ç½‘ç»œSIMå¡èµ„æºç®¡ç†è§£å†³æ–¹æ¡ˆ

