# NSRS Kubernetes éƒ¨ç½²é…ç½®

æœ¬ç›®å½•åŒ…å« NSRS ç³»ç»Ÿåœ¨ Kubernetes ç¯å¢ƒä¸­çš„éƒ¨ç½²é…ç½®ï¼Œé‡‡ç”¨ç‰ˆæœ¬åŒ–ç®¡ç†æ–¹å¼ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
nsrs-deploy/
â”œâ”€â”€ README.md                    # æœ¬æ–‡ä»¶
â”œâ”€â”€ build-integrated.bat         # Windows é›†æˆæ„å»ºè„šæœ¬
â”œâ”€â”€ build-integrated.sh          # Linux/Mac é›†æˆæ„å»ºè„šæœ¬
â”œâ”€â”€ k8s/                         # ç©ºç›®å½• (å†å²é—ç•™)
â””â”€â”€ v1.0.0/                      # ç‰ˆæœ¬ 1.0.0 éƒ¨ç½²é…ç½®
    â”œâ”€â”€ README.md                # ç‰ˆæœ¬è¯´æ˜
    â”œâ”€â”€ CHANGELOG.md             # å˜æ›´æ—¥å¿—
    â”œâ”€â”€ DEPLOYMENT-GUIDE.md      # è¯¦ç»†éƒ¨ç½²æŒ‡å—
    â”œâ”€â”€ QUICK-START.md           # å¿«é€Ÿå¼€å§‹æŒ‡å—
    â”œâ”€â”€ deploy.sh                # Linux/Mac éƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ deploy.bat               # Windows éƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ docker/                  # Docker é…ç½®
    â”‚   â””â”€â”€ Dockerfile           # åº”ç”¨é•œåƒæ„å»ºæ–‡ä»¶
    â”œâ”€â”€ k8s/                     # Kubernetes é…ç½®æ–‡ä»¶
    â”‚   â”œâ”€â”€ base/                # åŸºç¡€é…ç½®
    â”‚   â”‚   â”œâ”€â”€ namespace.yaml   # å‘½åç©ºé—´
    â”‚   â”‚   â”œâ”€â”€ configmap.yaml   # é…ç½®æ˜ å°„
    â”‚   â”‚   â”œâ”€â”€ secret.yaml      # å¯†é’¥
    â”‚   â”‚   â”œâ”€â”€ deployment.yaml  # åº”ç”¨éƒ¨ç½²
    â”‚   â”‚   â”œâ”€â”€ service.yaml     # æœåŠ¡
    â”‚   â”‚   â””â”€â”€ ingress.yaml     # å…¥å£
    â”‚   â”œâ”€â”€ database/            # æ•°æ®åº“é…ç½®
    â”‚   â”‚   â”œâ”€â”€ mysql-configmap.yaml
    â”‚   â”‚   â”œâ”€â”€ mysql-pvc.yaml
    â”‚   â”‚   â”œâ”€â”€ mysql-deployment.yaml
    â”‚   â”‚   â””â”€â”€ mysql-service.yaml
    â”‚   â”œâ”€â”€ scaling/             # æ‰©ç¼©å®¹é…ç½®
    â”‚   â”‚   â””â”€â”€ hpa.yaml         # æ°´å¹³è‡ªåŠ¨æ‰©ç¼©å®¹
    â”‚   â””â”€â”€ monitoring/          # ç›‘æ§é…ç½®
    â”‚       â””â”€â”€ monitoring.yaml # ç›‘æ§å’Œå‘Šè­¦
    â””â”€â”€ scripts/                 # è¾…åŠ©è„šæœ¬
        â”œâ”€â”€ check-health.sh      # å¥åº·æ£€æŸ¥è„šæœ¬ (Linux/Mac)
        â”œâ”€â”€ check-health.bat     # å¥åº·æ£€æŸ¥è„šæœ¬ (Windows)
        â”œâ”€â”€ backup.sh            # å¤‡ä»½è„šæœ¬
        â””â”€â”€ cleanup.sh           # æ¸…ç†è„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ (v1.0.0)

#### Windows ç¯å¢ƒ
```cmd
cd v1.0.0
deploy.bat
```

#### Linux/Mac ç¯å¢ƒ
```bash
cd v1.0.0
chmod +x deploy.sh
./deploy.sh
```

### æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£

- **å¿«é€Ÿå¼€å§‹**: [v1.0.0/QUICK-START.md](v1.0.0/QUICK-START.md)
- **è¯¦ç»†éƒ¨ç½²æŒ‡å—**: [v1.0.0/DEPLOYMENT-GUIDE.md](v1.0.0/DEPLOYMENT-GUIDE.md)
- **ç‰ˆæœ¬è¯´æ˜**: [v1.0.0/README.md](v1.0.0/README.md)
- **å˜æ›´æ—¥å¿—**: [v1.0.0/CHANGELOG.md](v1.0.0/CHANGELOG.md)

## ğŸ“‹ ç‰ˆæœ¬ç®¡ç†

### å½“å‰ç‰ˆæœ¬

| ç‰ˆæœ¬ | çŠ¶æ€ | å‘å¸ƒæ—¥æœŸ | è¯´æ˜ |
|------|------|----------|------|
| v1.0.0 | âœ… ç¨³å®š | 2025-01-27 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«å®Œæ•´çš„ K8s éƒ¨ç½²é…ç½® |

### ç‰ˆæœ¬é€‰æ‹©æŒ‡å—

- **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ (v1.0.0)
- **æµ‹è¯•ç¯å¢ƒ**: å¯ä»¥ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬è¿›è¡Œæµ‹è¯•
- **å¼€å‘ç¯å¢ƒ**: å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬

## ğŸ”§ ç¯å¢ƒè¦æ±‚

### åŸºç¡€è¦æ±‚
- **Kubernetes**: 1.19 æˆ–æ›´é«˜ç‰ˆæœ¬
- **kubectl**: å·²é…ç½®å¹¶èƒ½è¿æ¥åˆ°é›†ç¾¤
- **Docker**: ç”¨äºæ„å»ºé•œåƒ
- **å­˜å‚¨**: æ”¯æŒ PVC çš„å­˜å‚¨ç±»

### èµ„æºè¦æ±‚
- **æœ€å°**: 2 CPU, 4GB å†…å­˜, 20GB å­˜å‚¨
- **æ¨è**: 4 CPU, 8GB å†…å­˜, 50GB å­˜å‚¨
- **ç”Ÿäº§**: 8 CPU, 16GB å†…å­˜, 100GB å­˜å‚¨

## ğŸ› ï¸ å¸¸ç”¨æ“ä½œ

### éƒ¨ç½²åº”ç”¨
```bash
# è¿›å…¥ç‰ˆæœ¬ç›®å½•
cd v1.0.0

# æ‰§è¡Œéƒ¨ç½²
./deploy.sh deploy
```

### æŸ¥çœ‹çŠ¶æ€
```bash
# æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
./deploy.sh status

# å¥åº·æ£€æŸ¥
./scripts/check-health.sh
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
./deploy.sh logs

# æˆ–ç›´æ¥ä½¿ç”¨ kubectl
kubectl logs -f deployment/nsrs-app -n nsrs
```

### å¤‡ä»½æ•°æ®
```bash
# å®Œæ•´å¤‡ä»½
./scripts/backup.sh

# ä»…å¤‡ä»½æ•°æ®åº“
./scripts/backup.sh --db-only
```

### æ¸…ç†éƒ¨ç½²
```bash
# å¸è½½åº”ç”¨
./deploy.sh undeploy

# å®Œå…¨æ¸…ç†
./scripts/cleanup.sh
```

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **Pod å¯åŠ¨å¤±è´¥**
   ```bash
   kubectl get pods -n nsrs
   kubectl describe pod <pod-name> -n nsrs
   kubectl logs <pod-name> -n nsrs
   ```

2. **æœåŠ¡æ— æ³•è®¿é—®**
   ```bash
   kubectl get svc -n nsrs
   kubectl get ingress -n nsrs
   ```

3. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   kubectl exec -it deployment/mysql -n nsrs -- mysql -u root -p
   ```

### è·å–å¸®åŠ©

- æŸ¥çœ‹è¯¦ç»†éƒ¨ç½²æŒ‡å—: [v1.0.0/DEPLOYMENT-GUIDE.md](v1.0.0/DEPLOYMENT-GUIDE.md)
- è¿è¡Œå¥åº·æ£€æŸ¥: `./scripts/check-health.sh`
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—: `kubectl logs -f deployment/nsrs-app -n nsrs`

## ğŸ“ˆ å‡çº§æŒ‡å—

### ç‰ˆæœ¬å‡çº§æ­¥éª¤

1. **å¤‡ä»½å½“å‰æ•°æ®**
   ```bash
   cd v1.0.0
   ./scripts/backup.sh
   ```

2. **ä¸‹è½½æ–°ç‰ˆæœ¬é…ç½®**
   ```bash
   # æ–°ç‰ˆæœ¬å‘å¸ƒåï¼Œå°†ä¼šæœ‰æ–°çš„ç‰ˆæœ¬ç›®å½•
   # ä¾‹å¦‚: v1.1.0/
   ```

3. **æ‰§è¡Œå‡çº§**
   ```bash
   cd v1.1.0  # æ–°ç‰ˆæœ¬ç›®å½•
   ./deploy.sh deploy
   ```

4. **éªŒè¯å‡çº§**
   ```bash
   ./scripts/check-health.sh
   ```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°ç‰ˆæœ¬

1. åˆ›å»ºæ–°çš„ç‰ˆæœ¬ç›®å½• (ä¾‹å¦‚: `v1.1.0/`)
2. å¤åˆ¶å¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶
3. æ›´æ–° `README.md` å’Œ `CHANGELOG.md`
4. æµ‹è¯•éƒ¨ç½²æµç¨‹
5. æ›´æ–°æœ¬æ–‡æ¡£çš„ç‰ˆæœ¬è¡¨æ ¼

### é…ç½®æ–‡ä»¶è§„èŒƒ

- ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬å· (Semantic Versioning)
- ä¿æŒå‘åå…¼å®¹æ€§
- æä¾›è¯¦ç»†çš„å˜æ›´è¯´æ˜
- åŒ…å«å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **ç¯å¢ƒä¿¡æ¯**:
   - Kubernetes ç‰ˆæœ¬
   - æ“ä½œç³»ç»Ÿ
   - ä½¿ç”¨çš„é…ç½®ç‰ˆæœ¬

2. **é”™è¯¯ä¿¡æ¯**:
   - é”™è¯¯æ—¥å¿—
   - Pod çŠ¶æ€
   - äº‹ä»¶ä¿¡æ¯

3. **é‡ç°æ­¥éª¤**:
   - æ“ä½œæ­¥éª¤
   - é¢„æœŸç»“æœ
   - å®é™…ç»“æœ

---

**ç»´æŠ¤è€…**: NSRS å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025-01-27  
**å½“å‰ç‰ˆæœ¬**: v1.0.0