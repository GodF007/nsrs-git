# NSRS系统文档转换工具使用说明

## 📖 概述

本工具集提供了将 `NSRS系统性能测试方案.md` 转换为Word、PDF、HTML等多种格式的完整解决方案。

## 🗂️ 文件结构

```
文档转换工具/
├── README.md                    # 详细说明文档
├── 快速使用指南.md              # 快速上手指南
├── 使用说明.md                  # 本文件
├── install-tools.bat            # 工具安装脚本
├── convert-to-word.bat          # Word转换脚本
├── convert-to-pdf.bat           # PDF转换脚本
├── convert-all.js               # Node.js转换脚本
├── package.json                 # Node.js项目配置
└── output/                      # 输出目录
    └── style.css               # HTML样式文件
```

## 🚀 快速开始

### 第一步：安装工具
```bash
# 方法1：运行自动安装脚本（推荐）
双击运行: install-tools.bat

# 方法2：手动安装
choco install pandoc miktex nodejs
```

### 第二步：选择转换方式

#### 🎯 方式1：一键批处理（最简单）
```bash
# 转换为Word
双击: convert-to-word.bat

# 转换为PDF  
双击: convert-to-pdf.bat
```

#### 🎯 方式2：Node.js脚本（功能最全）
```bash
# 安装依赖
npm install

# 执行转换
node convert-all.js
```

#### 🎯 方式3：命令行（最灵活）
```bash
# Word转换
pandoc "../NSRS系统性能测试方案.md" -o "output/文档.docx"

# PDF转换（中文优化）
pandoc "../NSRS系统性能测试方案.md" -o "output/文档.pdf" --pdf-engine=xelatex -V mainfont="SimSun"

# HTML转换
pandoc "../NSRS系统性能测试方案.md" -o "output/文档.html" --standalone
```

## 📋 支持的输出格式

| 格式 | 扩展名 | 特点 | 推荐场景 |
|------|--------|------|----------|
| Word | .docx | 可编辑，支持批注 | 文档评审、协作编辑 |
| PDF | .pdf | 格式固定，便于分发 | 正式发布、归档 |
| HTML | .html | 网页显示，响应式 | 在线查看、网站发布 |

## 🎨 自定义选项

### Word样式自定义
1. 创建 `template.docx` 模板文件
2. 设置所需的样式（标题、正文、表格等）
3. 转换时会自动应用模板样式

### PDF样式自定义
```bash
# 自定义字体
--pdf-engine=xelatex -V mainfont="Microsoft YaHei"

# 自定义页边距
-V geometry:margin=2cm

# 添加目录
--toc --toc-depth=3

# 章节编号
--number-sections
```

### HTML样式自定义
- 修改 `output/style.css` 文件
- 支持响应式设计
- 包含中文字体优化

## 🔧 故障排除

### 常见问题及解决方案

#### Q: 提示"pandoc不是内部或外部命令"
**解决方案：**
1. 运行 `install-tools.bat` 安装Pandoc
2. 或手动安装：`choco install pandoc`
3. 重启命令行窗口

#### Q: PDF转换失败，LaTeX错误
**解决方案：**
1. 安装MiKTeX：`choco install miktex`
2. 首次使用时允许MiKTeX自动安装缺失包
3. 使用XeLaTeX引擎：`--pdf-engine=xelatex`

#### Q: 中文显示为方框或乱码
**解决方案：**
1. 使用XeLaTeX引擎
2. 指定中文字体：`-V mainfont="SimSun"`
3. 确保系统已安装相应字体

#### Q: 表格格式异常
**解决方案：**
1. 检查Markdown表格语法
2. 复杂表格考虑使用HTML语法
3. 调整列宽设置

#### Q: 图片无法显示
**解决方案：**
1. 使用相对路径引用图片
2. 确保图片文件存在
3. 支持的格式：PNG、JPG、SVG

## 📊 输出文件说明

转换后的文件保存在 `output/` 目录，文件命名规则：

- `NSRS系统性能测试方案_基础版_[时间戳].docx`
- `NSRS系统性能测试方案_样式版_[时间戳].docx`（需要模板）
- `NSRS系统性能测试方案_[时间戳].pdf`
- `NSRS系统性能测试方案_高级版_[时间戳].pdf`（带目录）
- `NSRS系统性能测试方案_[时间戳].html`

## 🔄 版本信息

- **当前版本：** v1.0.0
- **更新日期：** 2025-08-13
- **兼容性：** Windows 10/11, Node.js 14+

## 📞 技术支持

如遇到问题：
1. 查看 `README.md` 详细文档
2. 查看 `快速使用指南.md`
3. 检查工具安装状态
4. 联系技术团队

## 🎯 最佳实践

1. **开发阶段：** 使用Markdown编写，便于版本控制
2. **评审阶段：** 转换为Word，便于批注和修改
3. **发布阶段：** 转换为PDF，确保格式一致性
4. **在线展示：** 转换为HTML，便于网页查看
5. **归档保存：** 保留原始Markdown文件

---

**提示：** 首次使用建议先运行 `install-tools.bat` 安装所需工具，然后查看 `快速使用指南.md` 了解具体操作步骤。